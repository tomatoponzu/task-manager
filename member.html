<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>メンバー詳細</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    h1 { color: #49a6e9; }
    .comment-box, .task-section { margin: 1rem 0; }
    .custom-button {
  background-color: #4CAF50; /* メインカラー（例） */
  color: white;
  padding: 6px 14px;
  margin: 4px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}
.custom-button:hover {
  background-color: #45a049;
}

/* 入力欄（input[type=text]など） */
.custom-input {
  padding: 6px 10px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 6px;
  margin-right: 6px;
}
    textarea { width: 100%; height: 60px; font-size: 1rem; }
    input[type="text"] { width: 70%; padding: 0.5rem; margin-right: 0.5rem; }
    ul { list-style: none; padding-left: 0; }
    li { margin-bottom: 0.5rem; }
    button { margin-left: 0.5rem; }
  </style>
</head>
<body>
  <a href="index.html">← 戻る</a>
  <h1 id="memberName">メンバー名</h1>

  <div class="comment-box">
    <label for="comment">ひとことコメント:</label><br>
    <textarea id="comment" placeholder="コメントを入力..."></textarea>
  </div>

  <div class="task-section">
    <h2>抱えているタスク</h2>

    <div>
      <input type="text" id="newTaskInput" placeholder="新しいタスクを入力..." />
      <button onclick="addTask()">追加</button>
    </div>

    <ul id="taskList"></ul>
  </div>

  <script>
    // ✅追加：タスクの読み込み
const tasksRef = ref(db, `members/${memberName}/tasks`);
push(taskRef, taskText);
onValue(tasksRef, snapshot => {
  taskListEl.innerHTML = '';
  snapshot.forEach(child => {
    const taskId = child.key;
    const taskText = child.val();

    const li = document.createElement('li');
    li.textContent = taskText;

    // 編集ボタン（オプション）
    const editBtn = document.createElement('button');
    editBtn.textContent = '編集';
    editBtn.onclick = () => {
      const newText = prompt("新しいタスク名", taskText);
      if (newText && newText.trim()) {
        set(ref(db, `members/${memberName}/tasks/${taskId}`), newText.trim());
      }
    };
    li.appendChild(editBtn);

    // 削除ボタン
    const delBtn = document.createElement('button');
    delBtn.textContent = '削除';
    delBtn.onclick = () => {
      remove(ref(db, `members/${memberName}/tasks/${taskId}`));
    };
    li.appendChild(delBtn);

    taskListEl.appendChild(li);
  });
});

function addTask() {
  const taskText = newTaskInput.value.trim();
  if (taskText) {
    push(tasksRef, taskText);
    newTaskInput.value = '';
  }
}
    const commentRef = ref(db, `members/${memberName}/comment`);
onValue(commentRef, snapshot => {
  commentField.value = snapshot.val() || '';
});
commentField.addEventListener('input', () => {
  set(commentRef, commentField.value);
});
    renderTasks();
  </script>
   <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDkjuSa7ejyiBe_HXpKAa5c_wha1jP5aMg",
    authDomain: "task-manager-dca88.firebaseapp.com",
    projectId: "task-manager-dca88",
    storageBucket: "task-manager-dca88.firebasestorage.app",
    messagingSenderId: "1067146481363",
    appId: "1:1067146481363:web:435bda68d0a127b3958e26"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const firestore = getFirestore(app);

    const urlParams = new URLSearchParams(window.location.search);
    const memberName = urlParams.get('name');
    document.getElementById('member-name').textContent = memberName;

    const tasksRef = ref(db, `members/${memberName}/tasks`);
    const taskList = document.getElementById('task-list');

    onValue(tasksRef, snapshot => {
      taskList.innerHTML = '';
      snapshot.forEach(child => {
        const li = document.createElement('li');
        li.className = 'task';
        li.textContent = child.val();
        const del = document.createElement('button');
        del.textContent = '削除';
        del.onclick = () => remove(ref(db, `members/${memberName}/tasks/${child.key}`));
        li.appendChild(del);
        taskList.appendChild(li);
      });
    });

    window.addTask = function () {
      const taskInput = document.getElementById('new-task');
      const task = taskInput.value.trim();
      if (task) {
        push(tasksRef, task);
        taskInput.value = '';
      }
    };
  </script>
</body>
</html>
